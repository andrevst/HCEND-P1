{"status":{},"contains_secrets":true,"product_version":"3.0.0.1","spec":{"description":"","resources":{"client_attrs":{"None":{"y":152.4560545393,"x":11.0954119027},"7379a377_deployment":{"y":350.3635649924,"x":-27.0247012193},"e63951b3_deployment":{"y":309.9772200939,"x":678.4137977363},"17cddb88_deployment":{"y":149.7899753999,"x":265.68789722},"21ce8a9c_deployment":{"y":578.7762638924,"x":270.6191506092}},"service_definition_list":[{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"b2ef5a3b_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"9ce6e0be_runbook","main_task_local_reference":{"kind":"app_task","name":"b2ef5a3b_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"9838535a_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"1119cf83_runbook","main_task_local_reference":{"kind":"app_task","name":"9838535a_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Restart"}],"name":"b7e78e52_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"3c565942_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"257d0171_runbook","main_task_local_reference":{"kind":"app_task","name":"b7e78e52_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"WebServer_Stop"}],"name":"e21927cf_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"WebServer_Stop","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl stop httpd\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"ab3e313c_runbook","main_task_local_reference":{"kind":"app_task","name":"e21927cf_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"WebServer_Restart"}],"name":"b5853d8d_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"WebServer_Restart","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl restart httpd\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"3c565942_runbook","main_task_local_reference":{"kind":"app_task","name":"b5853d8d_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[{"kind":"app_service","name":"MySQL"}],"name":"WebServer","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"1d2e8848_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"af3291f6_runbook","main_task_local_reference":{"kind":"app_task","name":"1d2e8848_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"34d4fb4d_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"533a09ef_runbook","main_task_local_reference":{"kind":"app_task","name":"34d4fb4d_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Restart"}],"name":"d8d47293_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"82af0128_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"84df2d51_runbook","main_task_local_reference":{"kind":"app_task","name":"d8d47293_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"HAProxy_Stop"}],"name":"4b299e5b_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"HAProxy_Stop","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl stop haproxy\r\nsudo systemctl daemon-reload\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"cf744d91_runbook","main_task_local_reference":{"kind":"app_task","name":"4b299e5b_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"HAProxy_Restart"}],"name":"53bc245e_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"HAProxy_Restart","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl daemon-reload\r\nsudo systemctl restart haproxy\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"82af0128_runbook","main_task_local_reference":{"kind":"app_task","name":"53bc245e_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[{"kind":"app_service","name":"WebServer"},{"kind":"app_service","name":"WebServer2"}],"name":"HAProxy","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"7d9a8263_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"d300c3a4_runbook","main_task_local_reference":{"kind":"app_task","name":"7d9a8263_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"62ca824e_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"9225f107_runbook","main_task_local_reference":{"kind":"app_task","name":"62ca824e_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Restart"}],"name":"57180162_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"3fb1bcc5_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"61bb8f38_runbook","main_task_local_reference":{"kind":"app_task","name":"57180162_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"MySQL_Stop"}],"name":"d092f621_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"MySQL_Stop","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl stop mysqld\r\n# sudo systemctl status mysqld.service\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccdba"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"0794dfee_runbook","main_task_local_reference":{"kind":"app_task","name":"d092f621_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"MySQL_Restart"}],"name":"a2fd78ee_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"MySQL_Restart","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl restart mysqld\r\n# sudo systemctl status mysqld.service\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccdba"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"3fb1bcc5_runbook","main_task_local_reference":{"kind":"app_task","name":"a2fd78ee_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[],"name":"MySQL","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"b2ef5a3b_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"9ce6e0be_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"b2ef5a3b_dag_cloned_1"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"9838535a_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"1119cf83_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"9838535a_dag_cloned_1"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Restart2"}],"name":"b7e78e52_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart2","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"3c565942_runbook_cloned_0"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"257d0171_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"b7e78e52_dag_cloned_1"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"WebServer2_Stop"}],"name":"e21927cf_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"WebServer2_Stop","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl stop httpd\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"ab3e313c_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"e21927cf_dag_cloned_1"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"WebServer2_Restart"}],"name":"b5853d8d_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"WebServer2_Restart","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl restart httpd\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"3c565942_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"b5853d8d_dag_cloned_1"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[{"kind":"app_service","name":"MySQL"}],"name":"WebServer2","port_list":[],"tier":"","variable_list":[],"description":""}],"substrate_definition_list":[{"description":"","action_list":[],"type":"AHV_VM","name":"WebServerAHV","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"editables":{"readiness_probe":{"timeout_secs":null},"create_spec":{"resources":{"nic_list":{},"serial_port_list":{},"boot_config":true,"disk_list":{"0":{"device_properties":{"disk_address":{}},"disk_size_mib":true}}}}},"os_type":"Linux","create_spec":{"name":"WebServer-@@{calm_array_index}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"bcec2174-e182-409f-bb8e-f85d93686ebc"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":1,"gpu_list":[],"memory_size_mib":1024,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: @@{teccadmin.username}@@\n    ssh-authorized-keys:\n      - @@{teccadmin.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"de0619ae-23ab-4b63-addf-4fc108f205b8","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"CentOS_8_Cloud","uuid":"ea2a7671-b96c-4edd-aa30-c553354214c0"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[],"type":"AHV_VM","name":"HAProxyAHV","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"editables":{"readiness_probe":{"timeout_secs":null},"create_spec":{"resources":{"nic_list":{},"serial_port_list":{},"boot_config":true,"disk_list":{"0":{"device_properties":{"disk_address":{}},"disk_size_mib":true}}}}},"os_type":"Linux","create_spec":{"name":"HAProxy-@@{calm_array_index}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"bcec2174-e182-409f-bb8e-f85d93686ebc"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":1,"gpu_list":[],"memory_size_mib":1024,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: @@{teccadmin.username}@@\n    ssh-authorized-keys:\n      - @@{teccadmin.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"de0619ae-23ab-4b63-addf-4fc108f205b8","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"CentOS_8_Cloud","uuid":"ea2a7671-b96c-4edd-aa30-c553354214c0"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"MySQLAHV"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"POST_SUBNET_LIST"},{"kind":"app_task","name":"POST_CREATE_VLAN"},{"kind":"app_task","name":"POST_PROJECT_LIST"}],"name":"4273fc88_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"POST_SUBNET_LIST"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"POST_CREATE_VLAN"}},{"from_task_reference":{"kind":"app_task","name":"POST_CREATE_VLAN"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"POST_PROJECT_LIST"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_substrate","name":"MySQLAHV"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"POST_SUBNET_LIST","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""},{"status":"FAILURE","code":400,"type":""}],"request_body":"{}","headers":[],"url":"https:\/\/34.82.200.16:9440\/api\/nutanix\/v3\/subnets\/list","response_paths":{"CLUSTER_UUID":"$.entities[0].status.cluster_reference.uuid","CLUSTER_NAME":"$.entities[0].status.cluster_reference.name","DEF_SUB_NAME":"$.entities[0].status.name","DEF_SUB_UUID":"$.entities[0].metadata.uuid"},"retry_interval":1,"method":"POST","retry_count":1,"authentication":{"type":"basic_with_cred","credential_local_reference":{"kind":"app_credential","name":"API_USER"}},"tls_verify":false,"content_type":"application\/json","connection_timeout":120,"type":"","proxy_type":""},"timeout_secs":"0","type":"HTTP","variable_list":[]},{"target_any_local_reference":{"kind":"app_substrate","name":"MySQLAHV"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"POST_CREATE_VLAN","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""},{"status":"FAILURE","code":400,"type":""}],"request_body":"{\r\n  \"spec\": {\r\n    \"description\": \"VLAN-@@{VLAN_ID}@@\",\r\n    \"resources\": {\r\n      \"subnet_type\": \"VLAN\",\r\n      \"vswitch_name\": \"br0\",\r\n      \"vlan_id\": @@{calm_int(VLAN_ID)}@@\r\n    },\r\n    \"cluster_reference\": {\r\n      \"kind\": \"cluster\",\r\n      \"name\": \"@@{CLUSTER_NAME}@@\",\r\n      \"uuid\": \"@@{CLUSTER_UUID}@@\"\r\n    },\r\n    \"name\": \"VLAN-@@{VLAN_ID}@@\"\r\n  },\r\n  \"api_version\": \"3.1.0\",\r\n  \"metadata\": {\r\n    \"kind\": \"subnet\",\r\n    \"spec_version\": 0,\r\n    \"spec_hash\": \"string\",\r\n    \"should_force_translate\": true,\r\n    \"name\": \"VLAN-@@{VLAN_ID}@@\"\r\n  }\r\n}","headers":[],"url":"https:\/\/34.82.200.16:9440\/api\/nutanix\/v3\/subnets","response_paths":{"VLAN_UUID":"$.metadata.uuid"},"retry_interval":1,"method":"POST","retry_count":1,"authentication":{"type":"basic_with_cred","credential_local_reference":{"kind":"app_credential","name":"API_USER"}},"tls_verify":false,"content_type":"application\/json","connection_timeout":120,"type":"","proxy_type":""},"timeout_secs":"0","type":"HTTP","variable_list":[]},{"target_any_local_reference":{"kind":"app_substrate","name":"MySQLAHV"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"POST_PROJECT_LIST","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""},{"status":"FAILURE","code":400,"type":""}],"request_body":"{}","headers":[],"url":"https:\/\/34.82.200.16:9440\/api\/nutanix\/v3\/projects\/list","response_paths":{"PROJECT_UUID":"$.entities[0].metadata.project_reference.uuid","PROJECT_NAME":"$.entities[0].metadata.project_reference.name","ACCOUNT_UUID":"$.entities[0].status.resources.account_reference_list.uuid","ACCOUNT_NAME":"$.entities[0].status.resources.account_reference_list.name"},"retry_interval":1,"method":"POST","retry_count":1,"authentication":{"type":"basic_with_cred","credential_local_reference":{"kind":"app_credential","name":"API_USER"}},"tls_verify":false,"content_type":"application\/json","connection_timeout":120,"type":"","proxy_type":""},"timeout_secs":"0","type":"HTTP","variable_list":[]}],"description":"","name":"e0b0bf2a_runbook","main_task_local_reference":{"kind":"app_task","name":"4273fc88_dag"},"variable_list":[]},"name":"pre_action_create"},{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"MySQLAHV"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"badb2b06_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"21539cfa_runbook","main_task_local_reference":{"kind":"app_task","name":"badb2b06_dag"},"variable_list":[]},"name":"post_action_delete"}],"type":"AHV_VM","name":"MySQLAHV","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"teccdba"}},"editables":{"readiness_probe":{"timeout_secs":null},"create_spec":{"resources":{"nic_list":{},"disk_list":{"0":{"device_properties":{"disk_address":{}}}},"memory_size_mib":true,"boot_config":true,"serial_port_list":{}}}},"os_type":"Linux","create_spec":{"name":"MYSQL-@@{calm_array_index}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"@@{small.VLAN_NAME.uuid}@@"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":1,"gpu_list":[],"memory_size_mib":1024,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: @@{teccdba.username}@@\n    ssh-authorized-keys:\n      - @@{teccdba.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"de0619ae-23ab-4b63-addf-4fc108f205b8","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"CentOS_8_Cloud","uuid":"ea2a7671-b96c-4edd-aa30-c553354214c0"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[],"type":"AHV_VM","name":"WebServerAHV2","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"editables":{"readiness_probe":{"timeout_secs":null},"create_spec":{"resources":{"nic_list":{},"serial_port_list":{},"boot_config":true,"disk_list":{"0":{"device_properties":{"disk_address":{}},"disk_size_mib":true}}}}},"os_type":"Linux","create_spec":{"name":"WebServer2-@@{calm_array_index}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"bcec2174-e182-409f-bb8e-f85d93686ebc"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":1,"gpu_list":[],"memory_size_mib":1024,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: @@{teccadmin.username}@@\n    ssh-authorized-keys:\n      - @@{teccadmin.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"de0619ae-23ab-4b63-addf-4fc108f205b8","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"CentOS_8_Cloud","uuid":"ea2a7671-b96c-4edd-aa30-c553354214c0"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]}],"credential_definition_list":[{"username":"teccadmin_user","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"zXndIdD7DJ9zo\/zN9gSu5xxcbywM\/yNwB8R5m\/FN\/z6Sh9zInNcxu14hfJIP9R\/X6e1n0iHAGfLqBU9FKJjSvix3dneRgI6oeTKJomB835alXi+dBC+IUXIKOvS6P1gvX1erkTm5fMBBgYDtaoNAmYLAkoQj69h87jkuvGtR7oX8g90Vkkffge8hI00ih9lbbp83rdh7xiJEuRKqRGf7jg2qthjIa1ELhKx+3evlCDPdjGc7b7A0MSwOmApUgHsp\/7VI+Ny7a90hLnM9EkVxmT5U\/G\/66PnACMVdjMCI4zqbRp0PxRchoSdi6tbXOSSxQb9JL9l\/lnu+Ae\/tjBmVDBuWy7Q\/r16mCRjEcYwZIakycQ0tmbFeFgg2lqxIS70MzGFZrbNi3hBiTItvNvMHlJUqMXEFYjtL0clU8Mxdxyyzavtcl1wMFXlHeazY+Un1S8xZTItrB9ddvlc4QqiSqbAPZ1n8nLJhPsbH446aXe7qr2iEc40sQkKhlddOoks6zRUNU8kC4246xnkErWvv7l47j2jHW+bxzALpnqPY788C3KLXDE19cRDiOjuwQd97mmFJOGIQufVRn\/juAjyvDe9V6SF9lS4gtahTycVJkYqWOZgd4v5p3SspzKFj9Emf3gIbefthd+LV4g4wNgs36tSii6y5EKSG1qtc6qsgcIbwodtjTOf3EPvXPal7R\/T248M9HM5ARsHV\/ueOD5fmHq+YbzsRXShZI96gsOtHHAyZ18eW+ucXJlB+V+Qy+vJ5zSfR1Txti1ZT4pAx7kUUbmYvJ9rV5BkZbsKe1Kq2zd9n2xVYX3s6hyeCSrLxsyLvolFoSWiMmznOnVybF0AHCG6Vu0g5CZj1S6JIC9cXTiLx+kAoAMR1pNGWLDCbeUr9pqVlqGVFxEE3kKy+0ZvtYOOy9n9a\/KiqIs0xF848RJMUf\/vPNFqrCygzNJnqMdkRGVDNbv4sM6bnHjaplmlPDqaVNtCG1GJDIsy2YLzASgDrGBEPdzLpRJbFJsB9Z0X8FtH5un3qsEVsPr6qrnfu8eVh4jwjvm4USM\/gRv1ZwjHfIA4S0Ltmw+2IodOSB2Eq1IuNtQlZmUwsBnGi7Q6mNp6j2MLaGcRk9lgDqxbKHv9Tup+sk3UNNJ\/FJJ764d+wVFlb3EEGkFrxcD+Q5jOftrVt\/zlbqdzWg9F+I75M\/knXCZvwKArV6Y6vPl28NQmKENsKw0Rc+nvovcPLhZIhBBVw0TT7m0uEtPUwT8555If\/mIMNJKtzx1jOxiN295YqSzqcWGqo9X+6Huof0K4CbLEkeL6a2MV3IxinYnye6LZxTZgpTTseu7j3xqmqrNt4HsGcV6Ehfufmc270x0QqbB8xNXVSYJxabR7mRo0jaeLzv+Z+WCMQa4PByQZvAg\/qhXaVqWi\/Md5DIni6ycl\/Gd4oSonNQf5Hfp0RhhY76boFo57H+ozpjQJdfp0IsLrm+Wf2+PORuCc1+UpNvw2d2wlZiZznYwOfDuUrFgNxcOuZzH\/2rmtbm70aDmK3NPYDtyu9sy92Tukk18YKOhwVMAurhboLbnF3HytTRZB9AWTIlFlq5fg48AHM8dOpNFbhRhDB3hS90t7HAT3oHkdobH55lJO9tHOf9lHzOY5DrdoACegEGb0GTmTmFgf2yeougo7RKwwSnQZb6oOfDoLbW8FfPtokoXdmFBcrZ0V3K8rbU9fV7qxfy2ok2Uw\/J3N58L9Y74uFKhTU\/S0F5IXMGQRWPQcfLNnj2LIrAObp7f\/AyBjA1QbJlPcCFYfvlzH2M5woAl4+s5oIB\/dkOouaJ8jxp1D3etXvC8QESKENsIK\/eVVxIGxyJVr8Cw7lJxS3ghf+yWoFzZW4Q61crcj\/mWc6cOCLBAoVsEL8QMLg4nVDhMMj1TYZiGfjjPZpMSzFWmuPJdwCYttkfg+vG+qafReH7DDaie+UFYLsDgUHpEyE41+i0VusLFtX\/75O6+wsqrn\/iiksqGIZ59ebyL3zI\/pK33Q9UXx\/3PBPcOowGhneaGDz\/ZxEdaJE68B17dsrxPLWG6Q7LynO7md8ZJcd2Y7OIlxDonWuCBWAYJggn9iMkWRxY63UGB0mI\/KQQ2E41R+ule97EIObm86a5LMPK7N6ccFAmFxIhfeUGsfg1LcgGmLQ0NES3DCLMjFt+N4NlGpwZRu29Lwr\/Oou1kdoExUVNlbobe\/MUOzOYZpNbQ3zX7Uzpu1c1oRHs+XIODvKV3ydqx\/UfzZCHG8olKi5\/nsOZ6iprJfISzXFZ2sJCOfU9cmB7\/9tVAkcYLXL5SPK\/p6VaijwnZjwAVONTQIp4cOlnCFUoQz48+3E\/olmIVjG64pUZ9\/UqCdIKGtgcsBOI3qFr+AsD\/Y7bBs36JN3EuZkj43dKuRBKrpw6+JLVH4edr2IoeLUD7P1YP1moypmOctjwirLas\/81dWHdyEC2ndAStP1TBGQsy8hmcN8if04ixvwkV4\/MK7XxO1\/uELlu9mFWTq2196+RLfxAOIMoBZ+Mewby+R9OnlD7U8adhdd8nC8+d\/ED\/J6\/Z0IgZM4TPSpmOnEVXx1pTbvF0Gl4I1Sa9GdydCdDgXbNsLfLkX5khn23iaEC7mEJZHsBeeVltriiMefsqKx7jKmbAC\/jKLPurspGBo0H8GOWNoJzZ7dnW\/lViQ8c3avCfTqgH3BkeApE\/x0sBweGjNEgMOyzKfTfVIUCcYfAQzHkls679FNDXW\/54epBnEOw0LR3P\/Y+zTtfQJG57sFnY3MUr6SYy567DCedpptWXMCQypMZ0Aut6q+2XE\/CNnXMFKlfHdNseKKNLG7\/g2wt\/ivZsKn3QQj\/VlBxuCUncc84FT5NsASgXnQ+UdptrYl27gswKKDrlBmnpZV5Z8ptoOtoDL3undWoX9xEEad4OV508NLny0Cn9ldvDeD+NDlZIpBoLTrx\/z6ac269tF1ffKw9\/\/sHbX\/09uUVEPRxsaf6mbMuO2dSd7+fDhZghW7ACxHdCl+QkwrIMug3iUB2MzD9rwcfutOIiMC22QBPDyXqVpoxN0oOA3\/V1h5p06qLKlb+NevoR0JMHA0KBLn5u4QqzDUueTLu9g9El9oi55CzKto3HGyN2HRF8\/UhLD6GO0ALOj5+9qRIIA24y2+fC+T+hB92VN1AS2EX7DT6R2oWDu7SAvmtGGiGA\/QAziZ93+BamD\/B55GH6c8OIY3Jx7CWGkAOSqxx+INLft4LwCHmxFmE19yeZmOcBz0PK3vJjMFcyRU+EzXRf3qOdqfebPJl9rwWq51JI78oN0Z0\/+nMtIttRjmXTm7L1xz:utf-8"},"name":"teccadmin"},{"username":"teccdba_user","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"VaM0QAPKVxqc3U1n1VU7q64F57rD4aanRTNkEVQDMzQjUs7ao1gXTHByvHJW96lamJm68+72qPeMEZl9oHv0rGLCtCRclcXKjWk6U\/KQLnV1AbuUYP2FuUKN+CTs95IBM3lMeD73nwqBKzObc1gWNSwYfBaLQNSXffsRNl5xkJcOrqJadbg7s9PK7oEgAuVtuzlRoQtYREdpj1L0iRps0gKiE0dq94\/3ma4l8Q5yvNdIEv530VtauvMS16zx8BaF+q8iPUBlUxgZaEklcA3q\/7wYoIQfHDU9RWXn5iEocmk\/HtYe3WYW5BJKDo3a1hBo0Kss06T68GdFUWbATrP5Nc9UqcaaMCkFtsOKv75gsdHr8mrYnMpZS90391xupZoeUH2nyASzSwQjJlbNo9qtOm6+phssRJ1eE+V3n8\/pMiQv64ZMgi4qt+Plhs6nE2NRTZNIGyawEu4cv4ylhitvOYRR6zahknDP+wFfU5OGwanl0zdDmNnhU2LlwryC2sXsdAm+1b4W7fLn4aaUgvBc0yAgyfF9fcomVNfRXD\/qtqGi6V1nEHMrBOPSIyAPfMaxWrquW7jc8nWllgLdPGP\/\/czaD471TZ7ibzQ2nLwUCJhsDkO4xgJcHT\/FZD2k15Nme0K+S4ImuuxzjElIqqJ8ZnCXXQUSJIfHRbmKDZsVVVj9f48auCyhHqc9b7FUWD6BT+baH5nYJt\/YKaqaq\/3kwnYjqFaKFwznxxtu1jew3QKNgxqUpGDwUTxwmQgFLJmgDKUhC+Ed+5M2cC5BEpYTLqX1Mq5EaoqhAmylux3OA2L9NKmJeWNKpT50fRsGR3UHCL5lTwrrlq4+Nyt+1tTHnMbSBIxmEPhjb9jqsHZDs2oGoveVAxeVKcvbDkPisH\/FK4q\/1AxvpctpYD5KZyA7ahCUAPW4d70zqOSB7aNEJ7bedmvtgwmtVr7Hnn+2NDNnUcsFLoGYTWL+X1sdgMbBYYcCVi3+Oqii\/9fhh+pnJn1ETf6DemT9Bmr31qVz7sTOhWFF1kBsJrqh4aI2LOW07B0iYkDM46rz6YKNx\/F2c816mCsTZXz3fX07fNZBKxIVpA\/KWLnxSjs5NNToR1nDvmZ1R4WJw3Z643b7RF6xw6BIWRoAFyp9CRrxsmarWxnNErKzqGYzLSOYiLHD53B6H81+nMjBxVmzS4gyLyKADFLeXCjICXfukHiFzPrAnhx8QtFZ97vILurNYep30rtsifdJYs1Vowe72R1O6pqs+8M8EloyEqA6YLTARPBdPkf8M84\/25\/qMMmp3F5NmQk\/vLoqqjZp6AbwCmbM7RQpZUSJMWLy2ldoAD8iIyAx62AyvCgYRRBONzKYBElMuN2LOSb7H5eng2Hz50eRjhn3BQ6uaak74lGYN2RWF3VBXMexhhBJuQ\/9qEDx+5bA\/i8gtJGDfDzom5pBH0tHBIOadgMUCITttsupiLDdmkYLHDNPdm9PFN+17xKKCoZByOL9pzZkxcWMCcVN7p+2+iiyumSoVfWkyNb2ClUZA\/eOVHmCikB14JA81tDX5n\/N0HTV8MTKXibLgG7AfOKgoPyF4oDdiz74aKC3PG1WczSJ25dZUTWmvIYCrkkulUww80VNu3vA7\/PyaKDxKds0\/fYLghA\/UcpBxxw1KI3HGZJwOsrqVg4hcWwWJymqVl9XPDIEEQlefDftjB+Y\/wAgyFR62S36JzUdfGFaVZfcjIlkyEsSrtbuvg6gmDlitUGui35\/2ELHuP6tUld2RgaN4QvM7ycffCIiOAm1jMbhCzcuSFznKdeBV1AraeQML2r4sL5kxOi63Ik1BZPMbynKwrJYY\/Qanvlh+Tj0f2K46NMEoODEPVV1EMRHJfxOCe3kkjvRvPbf2MWNHR\/4qVa0Db2B0GbGsjXwQDIMxzgT8GwhidslJifS12eyJhjWfysTNRZ9NyCttN48T+7GtVBTX\/FJ8xZVcDX8EUJ7HtLBCfQhfNyxBxEE1tBUqQldDOp32antnmld3iH5fyMDCxjZkAOYgGVQ3ofWJKjIVIVmtlaJypS1g1Z8cK\/PVJSzRFJHV3iE75W6og\/fodUsqncFavD2pLbjyO5Iy9ypb9Ubg97QjzkgV4\/+QwJHO+Hkx7KWbcK2gxLvk7IQkX1uVblpiYoIy6XPT78VCgf97RI2LoLDmvThw6KMmuICjZGp3jbR35mEwDNUv+KpOniomkBAsjOAD+8Sp5FoVJ4Jbh9\/gAyMr+bAvD3ftfktA0KPlvesz1IdV7IUQWPhTwxrCBHpfGS1vWnfp6hDQDxH4aFlCFvzV2+\/d47dNtZPu2Scj9tMWhYGQvfhFpr6VGM873xJ3wWmSwkMpL6S5EO2y9KRlnsp1kfgyPmHD90bJb6shfdOAJKuqtc4kxkUGoFWgThfhWaoJruPPUZEteHi5oKZ3AahkN2k53F0eK16PXWF5PvJuSk9SBl\/v1Bqu0bBs11XAPe9hYPchPGFqQdsWzESBFku8WPTCT2E76Zr0sOVIWXFI6ZGb7DFjkVtoAKiMhVVM6h1mniEl6RVl02sS1ml\/TvNQq7hGjNtXKGlg0uJvdUxOeRMre682H\/B5giPjsGxQo0VqaUt4HusbR4IrfKOzXTKX1KI+tgobxYj7tds9w7jEoKJhgRDwWjynj16pa8qMwErOqAhIz40G9vVe6jqAJ4c2QPjcHVTZ1RdHVDLi+9hmSIU0Da7hdeidofGMAym1j2SKoIw5p3ryslvqsXLRruHPfHEsnt1txr29mODK38RBnoi2EJISh0kz22ZTBKWuCawnlgh0ZBI55OZ\/+\/GKpFAZU+dU\/BpiM58192hPzCltOONB5TGM54E3fRy+PmDvS3L\/aXc5J\/rQ7Ug1ahJjIn5F50mI97mQiVROgii8TGCcGG7gVMFRXHRUkOJunL4GtsjEQ2S0SLS7DvhjwCn5uFpq0mUobuTG3T3IsoI77hqABXvM2OkLN\/d2kPaupbxgl1ww\/vcHstD+twPJhuAippPOmfMpFH0Fde+Eo9PqUQ5WOpw0QbG3Mlso\/30hxmD8O+b7cGgCMkOnefvX\/wrwb9IkZXVn9khbLo7g+TIPZ0vhWae9wtneSogzi74zmXItTEpHSnAImhMUgmkC\/WhRVH0ACKD9dediYIA01PfTzlFdNYWIZZSTUdES8Rg09YlFBior18u9BW8w2aeXz7OOBjS9vvxmLuHenswEWbXXYIIdb5rPdYir7LxdfvTzQShVWoMWe6UgciO9Y3RdlLEF6B+YAbbeaDV+8FCC0KEOZv+QX3i9UUMqCL4EBEabz4ayeSyb8S+AgrWz3RC:utf-8"},"name":"teccdba"},{"username":"admin","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"6t\/77x9On0DUh69cZoyNqC2WxgYXyhTZDn2T0\/hm6l4YuE3MwB3zFkE=:utf-8"},"name":"API_USER"}],"package_definition_list":[{"description":"CentosOS image","action_list":[],"type":"SUBSTRATE_IMAGE","service_local_reference_list":[],"name":"CentOS_8_Cloud","version":"","options":{"type":"","name":"CentOS_8_Cloud","resources":{"image_type":"DISK_IMAGE","checksum":{"checksum_algorithm":"","type":"","checksum_value":""},"source_uri":"https:\/\/cloud.centos.org\/centos\/8\/x86_64\/images\/CentOS-8-GenericCloud-8.2.2004-20200611.2.x86_64.qcow2","version":{"product_version":"8","type":"","product_name":"CentOS"},"architecture":"X86_64","type":""},"description":""},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"WebServer"}],"name":"WebServer_Package","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"WebServer_Package"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Linux_OS_Update"},{"kind":"app_task","name":"Install_WebServer"},{"kind":"app_task","name":"3Tier_Webapp"}],"name":"33d23cd4_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Linux_OS_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Install_WebServer"}},{"from_task_reference":{"kind":"app_task","name":"Install_WebServer"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"3Tier_Webapp"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Linux_OS_Update","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo yum -y update\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Install_WebServer","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\necho \"__ Install httpd and php...\"\r\nsudo yum install -y httpd\r\nsudo yum install -y php php-gd php-mbstring php-pdo php-mysqlnd\r\n\r\necho \"<IfModule mod_dir.c>\r\n        DirectoryIndex index.php index.html\r\n<\/IfModule>\" | sudo tee \/etc\/httpd\/conf.modules.d\/dir.conf\r\n\r\necho \"<?php\r\nphpinfo();\r\n?>\" | sudo tee \/var\/www\/html\/index.php\r\n\r\nsudo systemctl enable httpd\r\n\r\n# temporarily disable SELinux to prevent httpd to MySQL authentication issues\r\n# this is for testing only and should not be done in production environments\r\necho \"__ Temporarily disable SELinux...\"\r\nsudo setenforce 0\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"3Tier_Webapp","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\nset -ex\n\nsudo touch \/var\/www\/html\/index.php\nsudo chown @@{teccadmin.username}@@:@@{teccadmin.username}@@ \/var\/www\/html\/index.php\n\ncat > \/var\/www\/html\/index.php <<- \"EOF\"\n<html>\n<head>\n  <title>@@{calm_blueprint_name}@@<\/title>\n<\/head>\n<body>\n <h1>Hostname: @@{name}@@ at @@{address}@@, replica: @@{calm_array_index}@@<\/h1>\n<?php\ntry {\n  $dbh = new PDO('mysql:host=@@{MySQL.address}@@;dbname=@@{DATABASE_NAME}@@', '@@{MYSQL_APP_USER}@@', '@@{MYSQL_PASSWORD}@@', array(\n    PDO::ATTR_PERSISTENT => true,\n    PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,\n  ));\n\n  \/\/ ensure there is at least 1 row of data for the app to read\n  $data = $dbh->query(\"INSERT INTO @@{DATABASE_TABLE}@@ (id, time, message) VALUES (NULL, CURRENT_TIMESTAMP, '@@{calm_username}@@')\");\n\n  $data = $dbh->query('SELECT MAX(id) AS count FROM @@{DATABASE_TABLE}@@')->fetchAll(PDO::FETCH_COLUMN);\n  $count = $data[0]; \/\/print_r($data);\n  $data = $dbh->query(\"SELECT time, message FROM @@{DATABASE_TABLE}@@ WHERE id = $count\")->fetchAll(PDO::FETCH_ASSOC);\n  $time = $data[0]['time'];\n  $message = $data[0]['message'];\n\n  echo \"<p>Database records: $count<\/p>\\n\";\n  echo \"<p>Last maintainer: $message, on: $time<\/p>\\n\";\n  echo \"<h3>Web docroot: {$_SERVER[\"DOCUMENT_ROOT\"]}, file: {$_SERVER[\"SCRIPT_NAME\"]}<\/h3>\\n\";\n\n  $dbh = null;\n}\ncatch (PDOException $e) {\n  print \"Error!: \" . $e->getMessage() . \"<br\/>\";\n  print phpinfo();\n  die();\n}\n?><\/body>\n<\/html>\nEOF\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"437955dc_runbook","main_task_local_reference":{"kind":"app_task","name":"33d23cd4_dag"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"WebServer_Package"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Uninstall_WebServer"}],"name":"2056e4c5_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Uninstall_WebServer","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\nsudo rm -rf \/var\/www\/html\/* || true\r\nsudo yum erase -y httpd php || true\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"69b28771_runbook","main_task_local_reference":{"kind":"app_task","name":"2056e4c5_dag"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"HAProxy"}],"name":"HAProxy_Package","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"HAProxy_Package"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Linux_OS_Update"},{"kind":"app_task","name":"HAProxy_Install"}],"name":"4773a1cf_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Linux_OS_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"HAProxy_Install"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Linux_OS_Update","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo yum -y update\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"HAProxy_Install","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\nset -ex\n\necho \"__ HAProxy installation...\"\nsudo yum install -y haproxy &&\n  sudo systemctl enable haproxy || true # idempotent\nhaproxy -v\n\necho \"__ HAProxy configuration...\"\n# http:\/\/cbonte.github.io\/haproxy-dconv\/1.8\/configuration.html#4\nport=80\n\necho \"global\n  log 127.0.0.1 local0\n  log 127.0.0.1 local1 notice\n  maxconn 4096\n  quiet\n  user haproxy\n  group haproxy\ndefaults\n  log global\n  mode http\n  retries 3\n  timeout client 50s\n  timeout connect 5s\n  timeout server 50s\n  option dontlognull\n  option httplog\n  option redispatch\n  balance  roundrobin\n# Set up application listeners here.\nlisten stats\n  bind *:8080\n  mode http\n  log global\n  stats enable\n  stats hide-version\n  stats refresh 30s\n  stats show-node\n  stats uri \/stats\n#listen admin\n#  bind 127.0.0.1:22002\n#  mode http\n#  stats uri \/\nfrontend http\n  bind *:${port}\n  maxconn 2000\n  default_backend servers-http\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\n\nsudo sed -i 's\/server host-\/#server host-\/g' \/etc\/haproxy\/haproxy.cfg\n\nhosts=$(echo \"@@{WebServer.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\nfor host in $hosts; do\n  echo  \"  server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\ndone\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"5d667f9d_runbook","main_task_local_reference":{"kind":"app_task","name":"4773a1cf_dag"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"HAProxy_Package"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Uninstall_HAProxy"}],"name":"978687e8_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Uninstall_HAProxy","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo yum -y erase haproxy\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"bb501356_runbook","main_task_local_reference":{"kind":"app_task","name":"978687e8_dag"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"MySQL"}],"name":"MySQL__Package","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"MySQL__Package"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Linux_OS_Update"},{"kind":"app_task","name":"MySQL_Install"}],"name":"f0266aea_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Linux_OS_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"MySQL_Install"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Linux_OS_Update","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo yum -y update\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccdba"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"MySQL_Install","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\nset -ex\n\n# Assuming CentOS\/RedHat 8.2\necho \"__ Mysql installation...\"\n# https:\/\/dev.mysql.com\/doc\/refman\/8.0\/en\/linux-installation-yum-repo.html\n\nsudo yum install -y \"http:\/\/repo.mysql.com\/mysql80-community-release-el8.rpm\" &&\n  sudo yum module -y disable mysql &&\n  sudo yum install -y mysql-community-server\n\n# database must be started for SQL configuration\nsudo systemctl start mysqld\n# database should start on OS boot\nsudo systemctl enable mysqld\n# sudo systemctl status mysqld.service\n\necho \"__ Altering database root password...\"\n\nmysql --user=root --connect-expired-password \\\n  --password=\"$(sudo grep -oP 'temporary password(.*): \\K(\\S+)' \/var\/log\/mysqld.log)\" <<- EOF\n\nSET GLOBAL validate_password.policy=LOW;\nALTER user 'root'@'localhost' IDENTIFIED BY '@@{MYSQL_PASSWORD}@@';\n\nFLUSH PRIVILEGES;\nEOF\n\necho \"__ Creating database, table, and app user permissions...\"\n\nmysql --user=root --password='@@{MYSQL_PASSWORD}@@' <<- \"EOF\"\n\nCREATE DATABASE IF NOT EXISTS @@{DATABASE_NAME}@@ ;\nCREATE TABLE IF NOT EXISTS @@{DATABASE_NAME}@@.@@{DATABASE_TABLE}@@ ( \\\n  id INT NOT NULL AUTO_INCREMENT , \\\n  time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP , \\\n  message VARCHAR(80) NULL DEFAULT NULL , \\\n  PRIMARY KEY (id)) \\\n  ENGINE = InnoDB CHARSET=ascii COLLATE ascii_general_ci COMMENT = 'testing';\n\nFLUSH PRIVILEGES;\nCREATE USER '@@{MYSQL_APP_USER}@@'@'%' IDENTIFIED WITH mysql_native_password BY '@@{MYSQL_PASSWORD}@@' \\\n  REQUIRE NONE WITH MAX_QUERIES_PER_HOUR 0 MAX_CONNECTIONS_PER_HOUR 0 MAX_UPDATES_PER_HOUR 0 MAX_USER_CONNECTIONS 0;\nGRANT SELECT, INSERT ON *.* TO '@@{MYSQL_APP_USER}@@'@'%';\n\nCREATE USER '@@{MYSQL_APP_USER}@@'@'localhost' IDENTIFIED WITH mysql_native_password BY '@@{MYSQL_PASSWORD}@@' \\\n  REQUIRE NONE WITH MAX_QUERIES_PER_HOUR 0 MAX_CONNECTIONS_PER_HOUR 0 MAX_UPDATES_PER_HOUR 0 MAX_USER_CONNECTIONS 0;\nGRANT SELECT, INSERT ON *.* TO '@@{MYSQL_APP_USER}@@'@'localhost';\n\nFLUSH PRIVILEGES;\nEOF\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccdba"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"6b1756f4_runbook","main_task_local_reference":{"kind":"app_task","name":"f0266aea_dag"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"MySQL__Package"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"MySQL_Uninstall"}],"name":"ae26dd5b_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"MySQL_Uninstall","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\necho \"Generic uninstall script, goodbye!\"\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccdba"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"82c99a18_runbook","main_task_local_reference":{"kind":"app_task","name":"ae26dd5b_dag"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"WebServer2"}],"name":"WebServer2_Package","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"WebServer2_Package"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Linux_OS_Update"},{"kind":"app_task","name":"Install_WebServer2"},{"kind":"app_task","name":"3Tier_Webapp2"}],"name":"33d23cd4_dag_cloned_1","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Linux_OS_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Install_WebServer2"}},{"from_task_reference":{"kind":"app_task","name":"Install_WebServer2"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"3Tier_Webapp2"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Linux_OS_Update","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo yum -y update\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Install_WebServer2","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\necho \"__ Install httpd and php...\"\r\nsudo yum install -y httpd\r\nsudo yum install -y php php-gd php-mbstring php-pdo php-mysqlnd\r\n\r\necho \"<IfModule mod_dir.c>\r\n        DirectoryIndex index.php index.html\r\n<\/IfModule>\" | sudo tee \/etc\/httpd\/conf.modules.d\/dir.conf\r\n\r\necho \"<?php\r\nphpinfo();\r\n?>\" | sudo tee \/var\/www\/html\/index.php\r\n\r\nsudo systemctl enable httpd\r\n\r\n# temporarily disable SELinux to prevent httpd to MySQL authentication issues\r\n# this is for testing only and should not be done in production environments\r\necho \"__ Temporarily disable SELinux...\"\r\nsudo setenforce 0\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"3Tier_Webapp2","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\nset -ex\n\nsudo touch \/var\/www\/html\/index.php\nsudo chown @@{teccadmin.username}@@:@@{teccadmin.username}@@ \/var\/www\/html\/index.php\n\ncat > \/var\/www\/html\/index.php <<- \"EOF\"\n<html>\n<head>\n  <title>@@{calm_blueprint_name}@@<\/title>\n<\/head>\n<body>\n <h1>Hostname: @@{name}@@ at @@{address}@@, replica: @@{calm_array_index}@@<\/h1>\n<?php\ntry {\n  $dbh = new PDO('mysql:host=@@{MySQL.address}@@;dbname=@@{DATABASE_NAME}@@', '@@{MYSQL_APP_USER}@@', '@@{MYSQL_PASSWORD}@@', array(\n    PDO::ATTR_PERSISTENT => true,\n    PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,\n  ));\n\n  \/\/ ensure there is at least 1 row of data for the app to read\n  $data = $dbh->query(\"INSERT INTO @@{DATABASE_TABLE}@@ (id, time, message) VALUES (NULL, CURRENT_TIMESTAMP, '@@{calm_username}@@')\");\n\n  $data = $dbh->query('SELECT MAX(id) AS count FROM @@{DATABASE_TABLE}@@')->fetchAll(PDO::FETCH_COLUMN);\n  $count = $data[0]; \/\/print_r($data);\n  $data = $dbh->query(\"SELECT time, message FROM @@{DATABASE_TABLE}@@ WHERE id = $count\")->fetchAll(PDO::FETCH_ASSOC);\n  $time = $data[0]['time'];\n  $message = $data[0]['message'];\n\n  echo \"<p>Database records: $count<\/p>\\n\";\n  echo \"<p>Last maintainer: $message, on: $time<\/p>\\n\";\n  echo \"<h3>Web docroot: {$_SERVER[\"DOCUMENT_ROOT\"]}, file: {$_SERVER[\"SCRIPT_NAME\"]}<\/h3>\\n\";\n\n  $dbh = null;\n}\ncatch (PDOException $e) {\n  print \"Error!: \" . $e->getMessage() . \"<br\/>\";\n  print phpinfo();\n  die();\n}\n?><\/body>\n<\/html>\nEOF\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"437955dc_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"33d23cd4_dag_cloned_1"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"WebServer2_Package"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Uninstall_WebServer2"}],"name":"2056e4c5_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Uninstall_WebServer2","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\nsudo rm -rf \/var\/www\/html\/* || true\r\nsudo yum erase -y httpd php || true\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"69b28771_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"2056e4c5_dag_cloned_1"},"variable_list":[]}},"variable_list":[]}],"app_profile_list":[{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"name":"17cddb88_deployment","min_replicas":"2","default_replicas":"2","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"4","package_local_reference_list":[{"kind":"app_package","name":"WebServer_Package"}],"substrate_local_reference":{"kind":"app_substrate","name":"WebServerAHV"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"7379a377_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"HAProxy_Package"}],"substrate_local_reference":{"kind":"app_substrate","name":"HAProxyAHV"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"e63951b3_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"MySQL__Package"}],"substrate_local_reference":{"kind":"app_substrate","name":"MySQLAHV"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"21ce8a9c_deployment","min_replicas":"2","default_replicas":"2","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"4","package_local_reference_list":[{"kind":"app_package","name":"WebServer2_Package"}],"substrate_local_reference":{"kind":"app_substrate","name":"WebServerAHV2"},"variable_list":[],"description":""}],"description":"","action_list":[{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"ScaleOut"},{"kind":"app_task","name":"HAProxy_Update"},{"kind":"app_task","name":"Restart"}],"name":"7633ba2c_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"HAProxy_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Restart"}},{"from_task_reference":{"kind":"app_task","name":"ScaleOut"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"HAProxy_Update"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"17cddb88_deployment"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"ScaleOut","attrs":{"scaling_count":"@@{SCALE_UNIT}@@","type":"","scaling_type":"SCALEOUT"},"timeout_secs":"0","type":"SCALING","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"HAProxy_Update","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\nset -ex\n\necho \"__ HAProxy installation...\"\nsudo yum install -y haproxy &&\n  sudo systemctl enable haproxy || true # idempotent\nhaproxy -v\n\necho \"__ HAProxy configuration...\"\n# http:\/\/cbonte.github.io\/haproxy-dconv\/1.8\/configuration.html#4\nport=80\n\necho \"global\n  log 127.0.0.1 local0\n  log 127.0.0.1 local1 notice\n  maxconn 4096\n  quiet\n  user haproxy\n  group haproxy\ndefaults\n  log global\n  mode http\n  retries 3\n  timeout client 50s\n  timeout connect 5s\n  timeout server 50s\n  option dontlognull\n  option httplog\n  option redispatch\n  balance  roundrobin\n# Set up application listeners here.\nlisten stats\n  bind *:8080\n  mode http\n  log global\n  stats enable\n  stats hide-version\n  stats refresh 30s\n  stats show-node\n  stats uri \/stats\n#listen admin\n#  bind 127.0.0.1:22002\n#  mode http\n#  stats uri \/\nfrontend http\n  bind *:${port}\n  maxconn 2000\n  default_backend servers-http\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\n\nsudo sed -i 's\/server host-\/#server host-\/g' \/etc\/haproxy\/haproxy.cfg\n\nhosts=$(echo \"@@{WebServer.address}@@,@@{WebServer2.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\nfor host in $hosts; do\n  echo  \"  server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\ndone\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"82af0128_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"a093b86b_runbook","main_task_local_reference":{"kind":"app_task","name":"7633ba2c_dag"},"variable_list":[]},"name":"WebScaleOut"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"HAProxy_Update"},{"kind":"app_task","name":"Restart"},{"kind":"app_task","name":"ScaleIn"}],"name":"06547e7d_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"HAProxy_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Restart"}},{"from_task_reference":{"kind":"app_task","name":"Restart"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"ScaleIn"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"HAProxy_Update","attrs":{"script":"#!\/usr\/bin\/env bash\nset -ex\n\necho \"__ HAProxy installation...\"\nsudo yum install -y haproxy &&\n  sudo systemctl enable haproxy || true # idempotent\nhaproxy -v\n\necho \"__ HAProxy configuration...\"\n# http:\/\/cbonte.github.io\/haproxy-dconv\/1.8\/configuration.html#4\nport=80\n\necho \"global\n  log 127.0.0.1 local0\n  log 127.0.0.1 local1 notice\n  maxconn 4096\n  quiet\n  user haproxy\n  group haproxy\ndefaults\n  log global\n  mode http\n  retries 3\n  timeout client 50s\n  timeout connect 5s\n  timeout server 50s\n  option dontlognull\n  option httplog\n  option redispatch\n  balance  roundrobin\n# Set up application listeners here.\nlisten stats\n  bind *:8080\n  mode http\n  log global\n  stats enable\n  stats hide-version\n  stats refresh 30s\n  stats show-node\n  stats uri \/stats\n#listen admin\n#  bind 127.0.0.1:22002\n#  mode http\n#  stats uri \/\nfrontend http\n  bind *:${port}\n  maxconn 2000\n  default_backend servers-http\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\n\nsudo sed -i 's\/server host-\/#server host-\/g' \/etc\/haproxy\/haproxy.cfg\n\nhosts=$(echo \"@@{WebServer.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\nfor host in $hosts; do\n  echo  \"  server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\ndone\n","type":"","command_line_args":"","exit_status":[],"script_type":"sh"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"82af0128_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"17cddb88_deployment"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"ScaleIn","attrs":{"scaling_count":"@@{SCALE_UNIT}@@","type":"","scaling_type":"SCALEIN"},"timeout_secs":"0","type":"SCALING","variable_list":[]}],"description":"","name":"8d458e50_runbook","main_task_local_reference":{"kind":"app_task","name":"06547e7d_dag"},"variable_list":[]},"name":"WebScaleIn"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"LBStop"},{"kind":"app_task","name":"DatabaseBackup"},{"kind":"app_task","name":"LBRestart"}],"name":"14eb2788_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"LBStop"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"DatabaseBackup"}},{"from_task_reference":{"kind":"app_task","name":"DatabaseBackup"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"LBRestart"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"LBStop","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"cf744d91_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"MySQL"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"DatabaseBackup","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\nmysqldump --all-databases --user=root --password='@@{MYSQL_PASSWORD}@@'\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccdba"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"LBRestart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"82af0128_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"d8d33f34_runbook","main_task_local_reference":{"kind":"app_task","name":"14eb2788_dag"},"variable_list":[]},"name":"DatabaseBackup"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"ScaleOut2"},{"kind":"app_task","name":"HAProxy_Update"},{"kind":"app_task","name":"Restart"}],"name":"99160d60_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"HAProxy_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Restart"}},{"from_task_reference":{"kind":"app_task","name":"ScaleOut2"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"HAProxy_Update"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"21ce8a9c_deployment"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"ScaleOut2","attrs":{"scaling_count":"@@{SCALE_UNIT}@@","type":"","scaling_type":"SCALEOUT"},"timeout_secs":"0","type":"SCALING","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"HAProxy_Update","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\nset -ex\n\necho \"__ HAProxy installation...\"\nsudo yum install -y haproxy &&\n  sudo systemctl enable haproxy || true # idempotent\nhaproxy -v\n\necho \"__ HAProxy configuration...\"\n# http:\/\/cbonte.github.io\/haproxy-dconv\/1.8\/configuration.html#4\nport=80\n\necho \"global\n  log 127.0.0.1 local0\n  log 127.0.0.1 local1 notice\n  maxconn 4096\n  quiet\n  user haproxy\n  group haproxy\ndefaults\n  log global\n  mode http\n  retries 3\n  timeout client 50s\n  timeout connect 5s\n  timeout server 50s\n  option dontlognull\n  option httplog\n  option redispatch\n  balance  roundrobin\n# Set up application listeners here.\nlisten stats\n  bind *:8080\n  mode http\n  log global\n  stats enable\n  stats hide-version\n  stats refresh 30s\n  stats show-node\n  stats uri \/stats\n#listen admin\n#  bind 127.0.0.1:22002\n#  mode http\n#  stats uri \/\nfrontend http\n  bind *:${port}\n  maxconn 2000\n  default_backend servers-http\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\n\nsudo sed -i 's\/server host-\/#server host-\/g' \/etc\/haproxy\/haproxy.cfg\n\nhosts=$(echo \"@@{WebServer.address}@@,@@{WebServer2.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\nfor host in $hosts; do\n  echo  \"  server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\ndone\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"82af0128_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"e183e9b7_runbook","main_task_local_reference":{"kind":"app_task","name":"99160d60_dag"},"variable_list":[]},"name":"WebScaleOut2"},{"description":"","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"HAProxy_Update"},{"kind":"app_task","name":"Restart"},{"kind":"app_task","name":"ScaleIn2"}],"name":"bf0c9ceb_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"HAProxy_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Restart"}},{"from_task_reference":{"kind":"app_task","name":"Restart"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"ScaleIn2"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"HAProxy_Update","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\nset -ex\n\necho \"__ HAProxy installation...\"\nsudo yum install -y haproxy &&\n  sudo systemctl enable haproxy || true # idempotent\nhaproxy -v\n\necho \"__ HAProxy configuration...\"\n# http:\/\/cbonte.github.io\/haproxy-dconv\/1.8\/configuration.html#4\nport=80\n\necho \"global\n  log 127.0.0.1 local0\n  log 127.0.0.1 local1 notice\n  maxconn 4096\n  quiet\n  user haproxy\n  group haproxy\ndefaults\n  log global\n  mode http\n  retries 3\n  timeout client 50s\n  timeout connect 5s\n  timeout server 50s\n  option dontlognull\n  option httplog\n  option redispatch\n  balance  roundrobin\n# Set up application listeners here.\nlisten stats\n  bind *:8080\n  mode http\n  log global\n  stats enable\n  stats hide-version\n  stats refresh 30s\n  stats show-node\n  stats uri \/stats\n#listen admin\n#  bind 127.0.0.1:22002\n#  mode http\n#  stats uri \/\nfrontend http\n  bind *:${port}\n  maxconn 2000\n  default_backend servers-http\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\n\nsudo sed -i 's\/server host-\/#server host-\/g' \/etc\/haproxy\/haproxy.cfg\n\nhosts=$(echo \"@@{WebServer.address}@@,@@{WebServer2.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\nfor host in $hosts; do\n  echo  \"  server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\ndone\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"82af0128_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"21ce8a9c_deployment"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"ScaleIn2","attrs":{"scaling_count":"@@{SCALE_UNIT}@@","type":"","scaling_type":"SCALEIN"},"timeout_secs":"0","type":"SCALING","variable_list":[]}],"description":"","name":"073eb035_runbook","main_task_local_reference":{"kind":"app_task","name":"bf0c9ceb_dag"},"variable_list":[]},"name":"WebScaleIn2"}],"name":"small","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"MYSQL_APP_USER","value":"tecc_webuser","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"regex":{"should_validate":true,"value":"^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{8,}$"},"val_type":"STRING","is_mandatory":true,"description":"MySQL password security are 8 or more characters with at least 1 uppercase 1 lowercase 1 symbol and a number","data_type":"BASE","type":"SECRET","name":"MYSQL_PASSWORD","value":"256b+ktE88Rl\/mYKF\/eGhQ4M5KDlXan+plX25x3FthfWFNAg3lCfV\/Lt8Q==:utf-8","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":"SECRET"},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"DATABASE_NAME","value":"webapp","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"DATABASE_TABLE","value":"tecc_dba_test","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"MYSQL_USER","value":"webapp_user","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"regex":{"should_validate":false,"value":"^[\\d]*$"},"val_type":"INT","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"SCALE_UNIT","value":"1","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"regex":{"should_validate":false,"value":"^[\\d]*$"},"val_type":"INT","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"VNET_ID","value":"999","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"VLAN_NAME","value":"999","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"regex":{"should_validate":false,"value":"^[\\d]*$"},"val_type":"INT","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"VLAN_ID","value":"999","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}]}],"published_service_definition_list":[],"default_credential_local_reference":{"kind":"app_credential","name":"teccadmin"},"type":"USER"},"name":"M5L2 3 Tier WebApp"},"api_version":"3.0","metadata":{"last_update_time":"1612935012915468","kind":"blueprint","spec_version":13,"creation_time":"1612932886990746","name":"M5L2 3 Tier WebApp"}}